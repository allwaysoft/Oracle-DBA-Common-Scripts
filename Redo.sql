SELECT TO_CHAR (TRUNC (redocompletion), 'YYYY/MM/DD - DY') as Date1, ROUND (SUM (redosize) / 1024 / 1024, 2) as Total_MB,SUM (cnt) as Total_Switches, ROUND (SUM (cnt) / 24, 1)  as Avg_Hour_Switches, ROUND (MAX (redosize) / 1024 / 1024, 2) as Max_Hour_MB,MAX (cnt)  as Max_Hour_Cnt FROM (  SELECT TRUNC (completion_time, 'HH24') redocompletion,SUM (blocks * block_size) redosize, COUNT (*) cnt FROM v$archived_log WHERE completion_time > SYSDATE - 30  GROUP BY TRUNC (completion_time, 'HH24')) GROUP BY TRUNC (redocompletion) ORDER BY 1